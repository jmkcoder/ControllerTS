{% extends "shared/_base.njk" %}

{% block content %}
<div class="container">
  <h1>{{ title }}</h1>
  <p>{{ subtitle }}</p>

  <div class="row">
    <div class="col-md-8">
      <h2>üîß HtmlHelper Demo</h2>
      <p>This page demonstrates the updated HtmlHelper with support for object actions.</p>
      
      <h3>üì¶ Object Actions (AJAX Only)</h3>
      <p>These buttons call object actions that return JSON data:</p>
      
      <div class="demo-section">
        <h4>1. Simple Object Action</h4>
        <button 
          mvc-controller="Home" 
          mvc-action="getUsersApi"
          mvc-result-target="users-result"
          mvc-loading-text="Loading users..."
          class="btn btn-primary">
          Get Users (Object Action)
        </button>
        <div id="users-result" class="result-area"></div>
      </div>

      <div class="demo-section">
        <h4>2. Stats API</h4>
        <button 
          mvc-controller="Home" 
          mvc-action="getStatsApi"
          mvc-result-target="stats-result"
          mvc-loading-text="Loading stats..."
          mvc-success-template='<div class="alert alert-info"><h5>üìä Application Statistics</h5><pre>{{ "{" }}{{ "{" }}result{{ "}" }}{{ "}" }}</pre></div>'
          class="btn btn-info">
          Get Application Stats
        </button>
        <div id="stats-result" class="result-area"></div>
      </div>

      <div class="demo-section">
        <h4>3. Search API with Parameters</h4>
        <form 
          mvc-controller="Home" 
          mvc-action="searchApi"
          mvc-result-target="search-result"
          mvc-reset-on-success="true"
          mvc-success-template='<div class="alert alert-success"><h5>üîç Search Results</h5><pre>{{ "{" }}{{ "{" }}result{{ "}" }}{{ "}" }}</pre></div>'>
          
          <div class="form-group">
            <label for="search-query">Search Query:</label>
            <input type="text" id="search-query" name="q" class="form-control" placeholder="Enter search term" />
          </div>
          
          <div class="form-group">
            <label for="search-category">Category:</label>
            <select id="search-category" name="category" class="form-control">
              <option value="all">All Categories</option>
              <option value="programming">Programming</option>
              <option value="architecture">Architecture</option>
              <option value="patterns">Patterns</option>
              <option value="features">Features</option>
            </select>
          </div>
          
          <button type="submit" class="btn btn-success">Search (Object Action)</button>
        </form>
        <div id="search-result" class="result-area"></div>
      </div>

      <h3>üè† View Actions (Mixed Behavior)</h3>
      <p>These buttons call regular view actions that can redirect or return data:</p>
      
      <div class="demo-section">
        <h4>4. Regular Action with JSON</h4>
        <button 
          mvc-controller="Home" 
          mvc-action="getJsonData"
          mvc-result-target="json-result"
          mvc-loading-text="Loading data..."
          class="btn btn-secondary">
          Get JSON Data (View Action)
        </button>
        <div id="json-result" class="result-area"></div>
      </div>

      <div class="demo-section">
        <h4>5. Redirect Actions</h4>
        <button 
          mvc-controller="Home" 
          mvc-action="redirectToAbout"
          class="btn btn-warning">
          Redirect to About (View Action)
        </button>
        
        <button 
          mvc-controller="Home" 
          mvc-action="redirectToGoogle"
          class="btn btn-danger">
          Redirect to Google (External)
        </button>
      </div>

      <h3>üß™ Error Handling</h3>
      <p>These demonstrate error scenarios:</p>
      
      <div class="demo-section">
        <h4>6. Invalid Controller</h4>
        <button 
          mvc-controller="nonexistent" 
          mvc-action="someAction"
          mvc-result-target="error-result1"
          mvc-error-template='<div class="alert alert-danger"><strong>‚ùå Error:</strong> {{ "{" }}{{ "{" }}error{{ "}" }}{{ "}" }}</div>'
          class="btn btn-dark">
          Call Invalid Controller
        </button>
        <div id="error-result1" class="result-area"></div>
      </div>

      <div class="demo-section">
        <h4>7. Invalid Action</h4>
        <button 
          mvc-controller="Home" 
          mvc-action="nonexistentAction"
          mvc-result-target="error-result2"
          mvc-error-template='<div class="alert alert-danger"><strong>‚ùå Error:</strong> {{ "{" }}{{ "{" }}error{{ "}" }}{{ "}" }}</div>'
          class="btn btn-dark">
          Call Invalid Action
        </button>
        <div id="error-result2" class="result-area"></div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="info-panel">
        <h3>üìã How It Works</h3>
        
        <h4>Object Actions (@objectAction)</h4>
        <ul>
          <li>‚úÖ Return JSON data only</li>
          <li>‚ùå Cannot render views</li>
          <li>‚ùå Cannot redirect</li>
          <li>üîß Use <code>Html.Ajax()</code> method</li>
          <li>üì± Perfect for API endpoints</li>
        </ul>

        <h4>View Actions (@action)</h4>
        <ul>
          <li>‚úÖ Can render views</li>
          <li>‚úÖ Can redirect</li>
          <li>‚úÖ Can return JSON</li>
          <li>üîß Use <code>Html.Action()</code> method</li>
          <li>üñºÔ∏è Perfect for page rendering</li>
        </ul>

        <h4>MVC Attributes</h4>
        <ul>
          <li><code>mvc-controller</code> - Controller name</li>
          <li><code>mvc-action</code> - Action name</li>
          <li><code>mvc-data</code> - JSON data to send</li>
          <li><code>mvc-result-target</code> - Element ID for result</li>
          <li><code>mvc-loading-text</code> - Loading button text</li>
          <li><code>mvc-success-template</code> - Success HTML template</li>
          <li><code>mvc-error-template</code> - Error HTML template</li>
          <li><code>mvc-reset-on-success</code> - Reset form on success</li>
        </ul>
      </div>

      <div class="navigation-panel">
        <h3>üß≠ Navigation Helper</h3>
        <p>Use JavaScript to navigate programmatically:</p>
        <pre><code>// Navigate to action
Html.navigateToAction('home', 'demo');

// Navigate with query params
Html.navigateToAction('home', 'search', {
  q: 'test',
  category: 'programming'
});

// Call object action via AJAX
const result = await Html.Ajax('home', 'getUsersApi');
console.log(result.data);</code></pre>
      </div>
    </div>
  </div>
</div>

<style>
.demo-section {
  margin: 20px 0;
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 5px;
  background-color: #f9f9f9;
}

.result-area {
  margin-top: 10px;
  min-height: 50px;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
  background-color: #fff;
}

.info-panel, .navigation-panel {
  background-color: #f8f9fa;
  padding: 15px;
  border-radius: 5px;
  margin-bottom: 20px;
}

.info-panel h4, .navigation-panel h3 {
  color: #495057;
  margin-top: 15px;
}

.info-panel ul {
  padding-left: 20px;
}

.alert {
  padding: 10px;
  border-radius: 4px;
  margin: 10px 0;
}

.alert-success {
  background-color: #d4edda;
  border-color: #c3e6cb;
  color: #155724;
}

.alert-info {
  background-color: #d1ecf1;
  border-color: #bee5eb;
  color: #0c5460;
}

.alert-danger {
  background-color: #f8d7da;
  border-color: #f5c6cb;
  color: #721c24;
}

.btn {
  display: inline-block;
  padding: 6px 12px;
  margin: 2px;
  font-size: 14px;
  font-weight: 400;
  line-height: 1.42857143;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  cursor: pointer;
  border: 1px solid transparent;
  border-radius: 4px;
  text-decoration: none;
}

.btn-primary { background-color: #007bff; border-color: #007bff; color: white; }
.btn-info { background-color: #17a2b8; border-color: #17a2b8; color: white; }
.btn-success { background-color: #28a745; border-color: #28a745; color: white; }
.btn-secondary { background-color: #6c757d; border-color: #6c757d; color: white; }
.btn-warning { background-color: #ffc107; border-color: #ffc107; color: #212529; }
.btn-danger { background-color: #dc3545; border-color: #dc3545; color: white; }
.btn-dark { background-color: #343a40; border-color: #343a40; color: white; }

.form-group {
  margin-bottom: 15px;
}

.form-control {
  display: block;
  width: 100%;
  padding: 6px 12px;
  font-size: 14px;
  line-height: 1.42857143;
  color: #555;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre {
  background-color: #f8f9fa;
  padding: 10px;
  border-radius: 3px;
  overflow-x: auto;
}

code {
  background-color: #f8f9fa;
  padding: 2px 4px;
  border-radius: 3px;
  font-family: monospace;
}
</style>
{% endblock %}
